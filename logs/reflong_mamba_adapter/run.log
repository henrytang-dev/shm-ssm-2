The following values were not passed to `accelerate launch` and had defaults used instead:
	`--num_processes` was set to a value of `1`
	`--num_machines` was set to a value of `1`
	`--mixed_precision` was set to a value of `'no'`
	`--dynamo_backend` was set to a value of `'no'`
To avoid this warning pass in values for each of the problematic parameters or run `accelerate config`.
2025-11-18 01:18:57 | WARNING | __main__ | Missing keys when loading weights: ['backbone.embedding.weight', 'backbone.layers.0.adapter.saliency_gate.proj.0.weight', 'backbone.layers.0.adapter.saliency_gate.proj.0.bias', 'backbone.layers.0.adapter.saliency_gate.proj.2.weight', 'backbone.layers.0.adapter.saliency_gate.proj.2.bias', 'backbone.layers.0.adapter.saliency_gate.proj.4.weight', 'backbone.layers.0.adapter.saliency_gate.proj.4.bias', 'backbone.layers.0.adapter.selective_memory.q_proj.weight', 'backbone.layers.0.adapter.selective_memory.q_proj.bias', 'backbone.layers.0.adapter.selective_memory.k_proj.weight', 'backbone.layers.0.adapter.selective_memory.k_proj.bias', 'backbone.layers.0.adapter.selective_memory.v_proj.weight', 'backbone.layers.0.adapter.selective_memory.v_proj.bias', 'backbone.layers.0.adapter.selective_memory.out_proj.weight', 'backbone.layers.0.adapter.selective_memory.out_proj.bias', 'backbone.layers.1.adapter.saliency_gate.proj.0.weight', 'backbone.layers.1.adapter.saliency_gate.proj.0.bias', 'backbone.layers.1.adapter.saliency_gate.proj.2.weight', 'backbone.layers.1.adapter.saliency_gate.proj.2.bias', 'backbone.layers.1.adapter.saliency_gate.proj.4.weight', 'backbone.layers.1.adapter.saliency_gate.proj.4.bias', 'backbone.layers.1.adapter.selective_memory.q_proj.weight', 'backbone.layers.1.adapter.selective_memory.q_proj.bias', 'backbone.layers.1.adapter.selective_memory.k_proj.weight', 'backbone.layers.1.adapter.selective_memory.k_proj.bias', 'backbone.layers.1.adapter.selective_memory.v_proj.weight', 'backbone.layers.1.adapter.selective_memory.v_proj.bias', 'backbone.layers.1.adapter.selective_memory.out_proj.weight', 'backbone.layers.1.adapter.selective_memory.out_proj.bias', 'backbone.layers.2.adapter.saliency_gate.proj.0.weight', 'backbone.layers.2.adapter.saliency_gate.proj.0.bias', 'backbone.layers.2.adapter.saliency_gate.proj.2.weight', 'backbone.layers.2.adapter.saliency_gate.proj.2.bias', 'backbone.layers.2.adapter.saliency_gate.proj.4.weight', 'backbone.layers.2.adapter.saliency_gate.proj.4.bias', 'backbone.layers.2.adapter.selective_memory.q_proj.weight', 'backbone.layers.2.adapter.selective_memory.q_proj.bias', 'backbone.layers.2.adapter.selective_memory.k_proj.weight', 'backbone.layers.2.adapter.selective_memory.k_proj.bias', 'backbone.layers.2.adapter.selective_memory.v_proj.weight', 'backbone.layers.2.adapter.selective_memory.v_proj.bias', 'backbone.layers.2.adapter.selective_memory.out_proj.weight', 'backbone.layers.2.adapter.selective_memory.out_proj.bias', 'backbone.layers.3.adapter.saliency_gate.proj.0.weight', 'backbone.layers.3.adapter.saliency_gate.proj.0.bias', 'backbone.layers.3.adapter.saliency_gate.proj.2.weight', 'backbone.layers.3.adapter.saliency_gate.proj.2.bias', 'backbone.layers.3.adapter.saliency_gate.proj.4.weight', 'backbone.layers.3.adapter.saliency_gate.proj.4.bias', 'backbone.layers.3.adapter.selective_memory.q_proj.weight', 'backbone.layers.3.adapter.selective_memory.q_proj.bias', 'backbone.layers.3.adapter.selective_memory.k_proj.weight', 'backbone.layers.3.adapter.selective_memory.k_proj.bias', 'backbone.layers.3.adapter.selective_memory.v_proj.weight', 'backbone.layers.3.adapter.selective_memory.v_proj.bias', 'backbone.layers.3.adapter.selective_memory.out_proj.weight', 'backbone.layers.3.adapter.selective_memory.out_proj.bias', 'backbone.layers.4.adapter.saliency_gate.proj.0.weight', 'backbone.layers.4.adapter.saliency_gate.proj.0.bias', 'backbone.layers.4.adapter.saliency_gate.proj.2.weight', 'backbone.layers.4.adapter.saliency_gate.proj.2.bias', 'backbone.layers.4.adapter.saliency_gate.proj.4.weight', 'backbone.layers.4.adapter.saliency_gate.proj.4.bias', 'backbone.layers.4.adapter.selective_memory.q_proj.weight', 'backbone.layers.4.adapter.selective_memory.q_proj.bias', 'backbone.layers.4.adapter.selective_memory.k_proj.weight', 'backbone.layers.4.adapter.selective_memory.k_proj.bias', 'backbone.layers.4.adapter.selective_memory.v_proj.weight', 'backbone.layers.4.adapter.selective_memory.v_proj.bias', 'backbone.layers.4.adapter.selective_memory.out_proj.weight', 'backbone.layers.4.adapter.selective_memory.out_proj.bias', 'backbone.layers.5.adapter.saliency_gate.proj.0.weight', 'backbone.layers.5.adapter.saliency_gate.proj.0.bias', 'backbone.layers.5.adapter.saliency_gate.proj.2.weight', 'backbone.layers.5.adapter.saliency_gate.proj.2.bias', 'backbone.layers.5.adapter.saliency_gate.proj.4.weight', 'backbone.layers.5.adapter.saliency_gate.proj.4.bias', 'backbone.layers.5.adapter.selective_memory.q_proj.weight', 'backbone.layers.5.adapter.selective_memory.q_proj.bias', 'backbone.layers.5.adapter.selective_memory.k_proj.weight', 'backbone.layers.5.adapter.selective_memory.k_proj.bias', 'backbone.layers.5.adapter.selective_memory.v_proj.weight', 'backbone.layers.5.adapter.selective_memory.v_proj.bias', 'backbone.layers.5.adapter.selective_memory.out_proj.weight', 'backbone.layers.5.adapter.selective_memory.out_proj.bias', 'backbone.layers.6.adapter.saliency_gate.proj.0.weight', 'backbone.layers.6.adapter.saliency_gate.proj.0.bias', 'backbone.layers.6.adapter.saliency_gate.proj.2.weight', 'backbone.layers.6.adapter.saliency_gate.proj.2.bias', 'backbone.layers.6.adapter.saliency_gate.proj.4.weight', 'backbone.layers.6.adapter.saliency_gate.proj.4.bias', 'backbone.layers.6.adapter.selective_memory.q_proj.weight', 'backbone.layers.6.adapter.selective_memory.q_proj.bias', 'backbone.layers.6.adapter.selective_memory.k_proj.weight', 'backbone.layers.6.adapter.selective_memory.k_proj.bias', 'backbone.layers.6.adapter.selective_memory.v_proj.weight', 'backbone.layers.6.adapter.selective_memory.v_proj.bias', 'backbone.layers.6.adapter.selective_memory.out_proj.weight', 'backbone.layers.6.adapter.selective_memory.out_proj.bias', 'backbone.layers.7.adapter.saliency_gate.proj.0.weight', 'backbone.layers.7.adapter.saliency_gate.proj.0.bias', 'backbone.layers.7.adapter.saliency_gate.proj.2.weight', 'backbone.layers.7.adapter.saliency_gate.proj.2.bias', 'backbone.layers.7.adapter.saliency_gate.proj.4.weight', 'backbone.layers.7.adapter.saliency_gate.proj.4.bias', 'backbone.layers.7.adapter.selective_memory.q_proj.weight', 'backbone.layers.7.adapter.selective_memory.q_proj.bias', 'backbone.layers.7.adapter.selective_memory.k_proj.weight', 'backbone.layers.7.adapter.selective_memory.k_proj.bias', 'backbone.layers.7.adapter.selective_memory.v_proj.weight', 'backbone.layers.7.adapter.selective_memory.v_proj.bias', 'backbone.layers.7.adapter.selective_memory.out_proj.weight', 'backbone.layers.7.adapter.selective_memory.out_proj.bias', 'backbone.layers.8.adapter.saliency_gate.proj.0.weight', 'backbone.layers.8.adapter.saliency_gate.proj.0.bias', 'backbone.layers.8.adapter.saliency_gate.proj.2.weight', 'backbone.layers.8.adapter.saliency_gate.proj.2.bias', 'backbone.layers.8.adapter.saliency_gate.proj.4.weight', 'backbone.layers.8.adapter.saliency_gate.proj.4.bias', 'backbone.layers.8.adapter.selective_memory.q_proj.weight', 'backbone.layers.8.adapter.selective_memory.q_proj.bias', 'backbone.layers.8.adapter.selective_memory.k_proj.weight', 'backbone.layers.8.adapter.selective_memory.k_proj.bias', 'backbone.layers.8.adapter.selective_memory.v_proj.weight', 'backbone.layers.8.adapter.selective_memory.v_proj.bias', 'backbone.layers.8.adapter.selective_memory.out_proj.weight', 'backbone.layers.8.adapter.selective_memory.out_proj.bias', 'backbone.layers.9.adapter.saliency_gate.proj.0.weight', 'backbone.layers.9.adapter.saliency_gate.proj.0.bias', 'backbone.layers.9.adapter.saliency_gate.proj.2.weight', 'backbone.layers.9.adapter.saliency_gate.proj.2.bias', 'backbone.layers.9.adapter.saliency_gate.proj.4.weight', 'backbone.layers.9.adapter.saliency_gate.proj.4.bias', 'backbone.layers.9.adapter.selective_memory.q_proj.weight', 'backbone.layers.9.adapter.selective_memory.q_proj.bias', 'backbone.layers.9.adapter.selective_memory.k_proj.weight', 'backbone.layers.9.adapter.selective_memory.k_proj.bias', 'backbone.layers.9.adapter.selective_memory.v_proj.weight', 'backbone.layers.9.adapter.selective_memory.v_proj.bias', 'backbone.layers.9.adapter.selective_memory.out_proj.weight', 'backbone.layers.9.adapter.selective_memory.out_proj.bias', 'backbone.layers.10.adapter.saliency_gate.proj.0.weight', 'backbone.layers.10.adapter.saliency_gate.proj.0.bias', 'backbone.layers.10.adapter.saliency_gate.proj.2.weight', 'backbone.layers.10.adapter.saliency_gate.proj.2.bias', 'backbone.layers.10.adapter.saliency_gate.proj.4.weight', 'backbone.layers.10.adapter.saliency_gate.proj.4.bias', 'backbone.layers.10.adapter.selective_memory.q_proj.weight', 'backbone.layers.10.adapter.selective_memory.q_proj.bias', 'backbone.layers.10.adapter.selective_memory.k_proj.weight', 'backbone.layers.10.adapter.selective_memory.k_proj.bias', 'backbone.layers.10.adapter.selective_memory.v_proj.weight', 'backbone.layers.10.adapter.selective_memory.v_proj.bias', 'backbone.layers.10.adapter.selective_memory.out_proj.weight', 'backbone.layers.10.adapter.selective_memory.out_proj.bias', 'backbone.layers.11.adapter.saliency_gate.proj.0.weight', 'backbone.layers.11.adapter.saliency_gate.proj.0.bias', 'backbone.layers.11.adapter.saliency_gate.proj.2.weight', 'backbone.layers.11.adapter.saliency_gate.proj.2.bias', 'backbone.layers.11.adapter.saliency_gate.proj.4.weight', 'backbone.layers.11.adapter.saliency_gate.proj.4.bias', 'backbone.layers.11.adapter.selective_memory.q_proj.weight', 'backbone.layers.11.adapter.selective_memory.q_proj.bias', 'backbone.layers.11.adapter.selective_memory.k_proj.weight', 'backbone.layers.11.adapter.selective_memory.k_proj.bias', 'backbone.layers.11.adapter.selective_memory.v_proj.weight', 'backbone.layers.11.adapter.selective_memory.v_proj.bias', 'backbone.layers.11.adapter.selective_memory.out_proj.weight', 'backbone.layers.11.adapter.selective_memory.out_proj.bias', 'backbone.layers.12.adapter.saliency_gate.proj.0.weight', 'backbone.layers.12.adapter.saliency_gate.proj.0.bias', 'backbone.layers.12.adapter.saliency_gate.proj.2.weight', 'backbone.layers.12.adapter.saliency_gate.proj.2.bias', 'backbone.layers.12.adapter.saliency_gate.proj.4.weight', 'backbone.layers.12.adapter.saliency_gate.proj.4.bias', 'backbone.layers.12.adapter.selective_memory.q_proj.weight', 'backbone.layers.12.adapter.selective_memory.q_proj.bias', 'backbone.layers.12.adapter.selective_memory.k_proj.weight', 'backbone.layers.12.adapter.selective_memory.k_proj.bias', 'backbone.layers.12.adapter.selective_memory.v_proj.weight', 'backbone.layers.12.adapter.selective_memory.v_proj.bias', 'backbone.layers.12.adapter.selective_memory.out_proj.weight', 'backbone.layers.12.adapter.selective_memory.out_proj.bias', 'backbone.layers.13.adapter.saliency_gate.proj.0.weight', 'backbone.layers.13.adapter.saliency_gate.proj.0.bias', 'backbone.layers.13.adapter.saliency_gate.proj.2.weight', 'backbone.layers.13.adapter.saliency_gate.proj.2.bias', 'backbone.layers.13.adapter.saliency_gate.proj.4.weight', 'backbone.layers.13.adapter.saliency_gate.proj.4.bias', 'backbone.layers.13.adapter.selective_memory.q_proj.weight', 'backbone.layers.13.adapter.selective_memory.q_proj.bias', 'backbone.layers.13.adapter.selective_memory.k_proj.weight', 'backbone.layers.13.adapter.selective_memory.k_proj.bias', 'backbone.layers.13.adapter.selective_memory.v_proj.weight', 'backbone.layers.13.adapter.selective_memory.v_proj.bias', 'backbone.layers.13.adapter.selective_memory.out_proj.weight', 'backbone.layers.13.adapter.selective_memory.out_proj.bias', 'backbone.layers.14.adapter.saliency_gate.proj.0.weight', 'backbone.layers.14.adapter.saliency_gate.proj.0.bias', 'backbone.layers.14.adapter.saliency_gate.proj.2.weight', 'backbone.layers.14.adapter.saliency_gate.proj.2.bias', 'backbone.layers.14.adapter.saliency_gate.proj.4.weight', 'backbone.layers.14.adapter.saliency_gate.proj.4.bias', 'backbone.layers.14.adapter.selective_memory.q_proj.weight', 'backbone.layers.14.adapter.selective_memory.q_proj.bias', 'backbone.layers.14.adapter.selective_memory.k_proj.weight', 'backbone.layers.14.adapter.selective_memory.k_proj.bias', 'backbone.layers.14.adapter.selective_memory.v_proj.weight', 'backbone.layers.14.adapter.selective_memory.v_proj.bias', 'backbone.layers.14.adapter.selective_memory.out_proj.weight', 'backbone.layers.14.adapter.selective_memory.out_proj.bias', 'backbone.layers.15.adapter.saliency_gate.proj.0.weight', 'backbone.layers.15.adapter.saliency_gate.proj.0.bias', 'backbone.layers.15.adapter.saliency_gate.proj.2.weight', 'backbone.layers.15.adapter.saliency_gate.proj.2.bias', 'backbone.layers.15.adapter.saliency_gate.proj.4.weight', 'backbone.layers.15.adapter.saliency_gate.proj.4.bias', 'backbone.layers.15.adapter.selective_memory.q_proj.weight', 'backbone.layers.15.adapter.selective_memory.q_proj.bias', 'backbone.layers.15.adapter.selective_memory.k_proj.weight', 'backbone.layers.15.adapter.selective_memory.k_proj.bias', 'backbone.layers.15.adapter.selective_memory.v_proj.weight', 'backbone.layers.15.adapter.selective_memory.v_proj.bias', 'backbone.layers.15.adapter.selective_memory.out_proj.weight', 'backbone.layers.15.adapter.selective_memory.out_proj.bias', 'backbone.layers.16.adapter.saliency_gate.proj.0.weight', 'backbone.layers.16.adapter.saliency_gate.proj.0.bias', 'backbone.layers.16.adapter.saliency_gate.proj.2.weight', 'backbone.layers.16.adapter.saliency_gate.proj.2.bias', 'backbone.layers.16.adapter.saliency_gate.proj.4.weight', 'backbone.layers.16.adapter.saliency_gate.proj.4.bias', 'backbone.layers.16.adapter.selective_memory.q_proj.weight', 'backbone.layers.16.adapter.selective_memory.q_proj.bias', 'backbone.layers.16.adapter.selective_memory.k_proj.weight', 'backbone.layers.16.adapter.selective_memory.k_proj.bias', 'backbone.layers.16.adapter.selective_memory.v_proj.weight', 'backbone.layers.16.adapter.selective_memory.v_proj.bias', 'backbone.layers.16.adapter.selective_memory.out_proj.weight', 'backbone.layers.16.adapter.selective_memory.out_proj.bias', 'backbone.layers.17.adapter.saliency_gate.proj.0.weight', 'backbone.layers.17.adapter.saliency_gate.proj.0.bias', 'backbone.layers.17.adapter.saliency_gate.proj.2.weight', 'backbone.layers.17.adapter.saliency_gate.proj.2.bias', 'backbone.layers.17.adapter.saliency_gate.proj.4.weight', 'backbone.layers.17.adapter.saliency_gate.proj.4.bias', 'backbone.layers.17.adapter.selective_memory.q_proj.weight', 'backbone.layers.17.adapter.selective_memory.q_proj.bias', 'backbone.layers.17.adapter.selective_memory.k_proj.weight', 'backbone.layers.17.adapter.selective_memory.k_proj.bias', 'backbone.layers.17.adapter.selective_memory.v_proj.weight', 'backbone.layers.17.adapter.selective_memory.v_proj.bias', 'backbone.layers.17.adapter.selective_memory.out_proj.weight', 'backbone.layers.17.adapter.selective_memory.out_proj.bias', 'backbone.layers.18.adapter.saliency_gate.proj.0.weight', 'backbone.layers.18.adapter.saliency_gate.proj.0.bias', 'backbone.layers.18.adapter.saliency_gate.proj.2.weight', 'backbone.layers.18.adapter.saliency_gate.proj.2.bias', 'backbone.layers.18.adapter.saliency_gate.proj.4.weight', 'backbone.layers.18.adapter.saliency_gate.proj.4.bias', 'backbone.layers.18.adapter.selective_memory.q_proj.weight', 'backbone.layers.18.adapter.selective_memory.q_proj.bias', 'backbone.layers.18.adapter.selective_memory.k_proj.weight', 'backbone.layers.18.adapter.selective_memory.k_proj.bias', 'backbone.layers.18.adapter.selective_memory.v_proj.weight', 'backbone.layers.18.adapter.selective_memory.v_proj.bias', 'backbone.layers.18.adapter.selective_memory.out_proj.weight', 'backbone.layers.18.adapter.selective_memory.out_proj.bias', 'backbone.layers.19.adapter.saliency_gate.proj.0.weight', 'backbone.layers.19.adapter.saliency_gate.proj.0.bias', 'backbone.layers.19.adapter.saliency_gate.proj.2.weight', 'backbone.layers.19.adapter.saliency_gate.proj.2.bias', 'backbone.layers.19.adapter.saliency_gate.proj.4.weight', 'backbone.layers.19.adapter.saliency_gate.proj.4.bias', 'backbone.layers.19.adapter.selective_memory.q_proj.weight', 'backbone.layers.19.adapter.selective_memory.q_proj.bias', 'backbone.layers.19.adapter.selective_memory.k_proj.weight', 'backbone.layers.19.adapter.selective_memory.k_proj.bias', 'backbone.layers.19.adapter.selective_memory.v_proj.weight', 'backbone.layers.19.adapter.selective_memory.v_proj.bias', 'backbone.layers.19.adapter.selective_memory.out_proj.weight', 'backbone.layers.19.adapter.selective_memory.out_proj.bias', 'backbone.layers.20.adapter.saliency_gate.proj.0.weight', 'backbone.layers.20.adapter.saliency_gate.proj.0.bias', 'backbone.layers.20.adapter.saliency_gate.proj.2.weight', 'backbone.layers.20.adapter.saliency_gate.proj.2.bias', 'backbone.layers.20.adapter.saliency_gate.proj.4.weight', 'backbone.layers.20.adapter.saliency_gate.proj.4.bias', 'backbone.layers.20.adapter.selective_memory.q_proj.weight', 'backbone.layers.20.adapter.selective_memory.q_proj.bias', 'backbone.layers.20.adapter.selective_memory.k_proj.weight', 'backbone.layers.20.adapter.selective_memory.k_proj.bias', 'backbone.layers.20.adapter.selective_memory.v_proj.weight', 'backbone.layers.20.adapter.selective_memory.v_proj.bias', 'backbone.layers.20.adapter.selective_memory.out_proj.weight', 'backbone.layers.20.adapter.selective_memory.out_proj.bias', 'backbone.layers.21.adapter.saliency_gate.proj.0.weight', 'backbone.layers.21.adapter.saliency_gate.proj.0.bias', 'backbone.layers.21.adapter.saliency_gate.proj.2.weight', 'backbone.layers.21.adapter.saliency_gate.proj.2.bias', 'backbone.layers.21.adapter.saliency_gate.proj.4.weight', 'backbone.layers.21.adapter.saliency_gate.proj.4.bias', 'backbone.layers.21.adapter.selective_memory.q_proj.weight', 'backbone.layers.21.adapter.selective_memory.q_proj.bias', 'backbone.layers.21.adapter.selective_memory.k_proj.weight', 'backbone.layers.21.adapter.selective_memory.k_proj.bias', 'backbone.layers.21.adapter.selective_memory.v_proj.weight', 'backbone.layers.21.adapter.selective_memory.v_proj.bias', 'backbone.layers.21.adapter.selective_memory.out_proj.weight', 'backbone.layers.21.adapter.selective_memory.out_proj.bias', 'backbone.layers.22.adapter.saliency_gate.proj.0.weight', 'backbone.layers.22.adapter.saliency_gate.proj.0.bias', 'backbone.layers.22.adapter.saliency_gate.proj.2.weight', 'backbone.layers.22.adapter.saliency_gate.proj.2.bias', 'backbone.layers.22.adapter.saliency_gate.proj.4.weight', 'backbone.layers.22.adapter.saliency_gate.proj.4.bias', 'backbone.layers.22.adapter.selective_memory.q_proj.weight', 'backbone.layers.22.adapter.selective_memory.q_proj.bias', 'backbone.layers.22.adapter.selective_memory.k_proj.weight', 'backbone.layers.22.adapter.selective_memory.k_proj.bias', 'backbone.layers.22.adapter.selective_memory.v_proj.weight', 'backbone.layers.22.adapter.selective_memory.v_proj.bias', 'backbone.layers.22.adapter.selective_memory.out_proj.weight', 'backbone.layers.22.adapter.selective_memory.out_proj.bias', 'backbone.layers.23.adapter.saliency_gate.proj.0.weight', 'backbone.layers.23.adapter.saliency_gate.proj.0.bias', 'backbone.layers.23.adapter.saliency_gate.proj.2.weight', 'backbone.layers.23.adapter.saliency_gate.proj.2.bias', 'backbone.layers.23.adapter.saliency_gate.proj.4.weight', 'backbone.layers.23.adapter.saliency_gate.proj.4.bias', 'backbone.layers.23.adapter.selective_memory.q_proj.weight', 'backbone.layers.23.adapter.selective_memory.q_proj.bias', 'backbone.layers.23.adapter.selective_memory.k_proj.weight', 'backbone.layers.23.adapter.selective_memory.k_proj.bias', 'backbone.layers.23.adapter.selective_memory.v_proj.weight', 'backbone.layers.23.adapter.selective_memory.v_proj.bias', 'backbone.layers.23.adapter.selective_memory.out_proj.weight', 'backbone.layers.23.adapter.selective_memory.out_proj.bias', 'backbone.layers.24.adapter.saliency_gate.proj.0.weight', 'backbone.layers.24.adapter.saliency_gate.proj.0.bias', 'backbone.layers.24.adapter.saliency_gate.proj.2.weight', 'backbone.layers.24.adapter.saliency_gate.proj.2.bias', 'backbone.layers.24.adapter.saliency_gate.proj.4.weight', 'backbone.layers.24.adapter.saliency_gate.proj.4.bias', 'backbone.layers.24.adapter.selective_memory.q_proj.weight', 'backbone.layers.24.adapter.selective_memory.q_proj.bias', 'backbone.layers.24.adapter.selective_memory.k_proj.weight', 'backbone.layers.24.adapter.selective_memory.k_proj.bias', 'backbone.layers.24.adapter.selective_memory.v_proj.weight', 'backbone.layers.24.adapter.selective_memory.v_proj.bias', 'backbone.layers.24.adapter.selective_memory.out_proj.weight', 'backbone.layers.24.adapter.selective_memory.out_proj.bias', 'backbone.layers.25.adapter.saliency_gate.proj.0.weight', 'backbone.layers.25.adapter.saliency_gate.proj.0.bias', 'backbone.layers.25.adapter.saliency_gate.proj.2.weight', 'backbone.layers.25.adapter.saliency_gate.proj.2.bias', 'backbone.layers.25.adapter.saliency_gate.proj.4.weight', 'backbone.layers.25.adapter.saliency_gate.proj.4.bias', 'backbone.layers.25.adapter.selective_memory.q_proj.weight', 'backbone.layers.25.adapter.selective_memory.q_proj.bias', 'backbone.layers.25.adapter.selective_memory.k_proj.weight', 'backbone.layers.25.adapter.selective_memory.k_proj.bias', 'backbone.layers.25.adapter.selective_memory.v_proj.weight', 'backbone.layers.25.adapter.selective_memory.v_proj.bias', 'backbone.layers.25.adapter.selective_memory.out_proj.weight', 'backbone.layers.25.adapter.selective_memory.out_proj.bias', 'backbone.layers.26.adapter.saliency_gate.proj.0.weight', 'backbone.layers.26.adapter.saliency_gate.proj.0.bias', 'backbone.layers.26.adapter.saliency_gate.proj.2.weight', 'backbone.layers.26.adapter.saliency_gate.proj.2.bias', 'backbone.layers.26.adapter.saliency_gate.proj.4.weight', 'backbone.layers.26.adapter.saliency_gate.proj.4.bias', 'backbone.layers.26.adapter.selective_memory.q_proj.weight', 'backbone.layers.26.adapter.selective_memory.q_proj.bias', 'backbone.layers.26.adapter.selective_memory.k_proj.weight', 'backbone.layers.26.adapter.selective_memory.k_proj.bias', 'backbone.layers.26.adapter.selective_memory.v_proj.weight', 'backbone.layers.26.adapter.selective_memory.v_proj.bias', 'backbone.layers.26.adapter.selective_memory.out_proj.weight', 'backbone.layers.26.adapter.selective_memory.out_proj.bias', 'backbone.layers.27.adapter.saliency_gate.proj.0.weight', 'backbone.layers.27.adapter.saliency_gate.proj.0.bias', 'backbone.layers.27.adapter.saliency_gate.proj.2.weight', 'backbone.layers.27.adapter.saliency_gate.proj.2.bias', 'backbone.layers.27.adapter.saliency_gate.proj.4.weight', 'backbone.layers.27.adapter.saliency_gate.proj.4.bias', 'backbone.layers.27.adapter.selective_memory.q_proj.weight', 'backbone.layers.27.adapter.selective_memory.q_proj.bias', 'backbone.layers.27.adapter.selective_memory.k_proj.weight', 'backbone.layers.27.adapter.selective_memory.k_proj.bias', 'backbone.layers.27.adapter.selective_memory.v_proj.weight', 'backbone.layers.27.adapter.selective_memory.v_proj.bias', 'backbone.layers.27.adapter.selective_memory.out_proj.weight', 'backbone.layers.27.adapter.selective_memory.out_proj.bias', 'backbone.layers.28.adapter.saliency_gate.proj.0.weight', 'backbone.layers.28.adapter.saliency_gate.proj.0.bias', 'backbone.layers.28.adapter.saliency_gate.proj.2.weight', 'backbone.layers.28.adapter.saliency_gate.proj.2.bias', 'backbone.layers.28.adapter.saliency_gate.proj.4.weight', 'backbone.layers.28.adapter.saliency_gate.proj.4.bias', 'backbone.layers.28.adapter.selective_memory.q_proj.weight', 'backbone.layers.28.adapter.selective_memory.q_proj.bias', 'backbone.layers.28.adapter.selective_memory.k_proj.weight', 'backbone.layers.28.adapter.selective_memory.k_proj.bias', 'backbone.layers.28.adapter.selective_memory.v_proj.weight', 'backbone.layers.28.adapter.selective_memory.v_proj.bias', 'backbone.layers.28.adapter.selective_memory.out_proj.weight', 'backbone.layers.28.adapter.selective_memory.out_proj.bias', 'backbone.layers.29.adapter.saliency_gate.proj.0.weight', 'backbone.layers.29.adapter.saliency_gate.proj.0.bias', 'backbone.layers.29.adapter.saliency_gate.proj.2.weight', 'backbone.layers.29.adapter.saliency_gate.proj.2.bias', 'backbone.layers.29.adapter.saliency_gate.proj.4.weight', 'backbone.layers.29.adapter.saliency_gate.proj.4.bias', 'backbone.layers.29.adapter.selective_memory.q_proj.weight', 'backbone.layers.29.adapter.selective_memory.q_proj.bias', 'backbone.layers.29.adapter.selective_memory.k_proj.weight', 'backbone.layers.29.adapter.selective_memory.k_proj.bias', 'backbone.layers.29.adapter.selective_memory.v_proj.weight', 'backbone.layers.29.adapter.selective_memory.v_proj.bias', 'backbone.layers.29.adapter.selective_memory.out_proj.weight', 'backbone.layers.29.adapter.selective_memory.out_proj.bias', 'backbone.layers.30.adapter.saliency_gate.proj.0.weight', 'backbone.layers.30.adapter.saliency_gate.proj.0.bias', 'backbone.layers.30.adapter.saliency_gate.proj.2.weight', 'backbone.layers.30.adapter.saliency_gate.proj.2.bias', 'backbone.layers.30.adapter.saliency_gate.proj.4.weight', 'backbone.layers.30.adapter.saliency_gate.proj.4.bias', 'backbone.layers.30.adapter.selective_memory.q_proj.weight', 'backbone.layers.30.adapter.selective_memory.q_proj.bias', 'backbone.layers.30.adapter.selective_memory.k_proj.weight', 'backbone.layers.30.adapter.selective_memory.k_proj.bias', 'backbone.layers.30.adapter.selective_memory.v_proj.weight', 'backbone.layers.30.adapter.selective_memory.v_proj.bias', 'backbone.layers.30.adapter.selective_memory.out_proj.weight', 'backbone.layers.30.adapter.selective_memory.out_proj.bias', 'backbone.layers.31.adapter.saliency_gate.proj.0.weight', 'backbone.layers.31.adapter.saliency_gate.proj.0.bias', 'backbone.layers.31.adapter.saliency_gate.proj.2.weight', 'backbone.layers.31.adapter.saliency_gate.proj.2.bias', 'backbone.layers.31.adapter.saliency_gate.proj.4.weight', 'backbone.layers.31.adapter.saliency_gate.proj.4.bias', 'backbone.layers.31.adapter.selective_memory.q_proj.weight', 'backbone.layers.31.adapter.selective_memory.q_proj.bias', 'backbone.layers.31.adapter.selective_memory.k_proj.weight', 'backbone.layers.31.adapter.selective_memory.k_proj.bias', 'backbone.layers.31.adapter.selective_memory.v_proj.weight', 'backbone.layers.31.adapter.selective_memory.v_proj.bias', 'backbone.layers.31.adapter.selective_memory.out_proj.weight', 'backbone.layers.31.adapter.selective_memory.out_proj.bias', 'backbone.layers.32.adapter.saliency_gate.proj.0.weight', 'backbone.layers.32.adapter.saliency_gate.proj.0.bias', 'backbone.layers.32.adapter.saliency_gate.proj.2.weight', 'backbone.layers.32.adapter.saliency_gate.proj.2.bias', 'backbone.layers.32.adapter.saliency_gate.proj.4.weight', 'backbone.layers.32.adapter.saliency_gate.proj.4.bias', 'backbone.layers.32.adapter.selective_memory.q_proj.weight', 'backbone.layers.32.adapter.selective_memory.q_proj.bias', 'backbone.layers.32.adapter.selective_memory.k_proj.weight', 'backbone.layers.32.adapter.selective_memory.k_proj.bias', 'backbone.layers.32.adapter.selective_memory.v_proj.weight', 'backbone.layers.32.adapter.selective_memory.v_proj.bias', 'backbone.layers.32.adapter.selective_memory.out_proj.weight', 'backbone.layers.32.adapter.selective_memory.out_proj.bias', 'backbone.layers.33.adapter.saliency_gate.proj.0.weight', 'backbone.layers.33.adapter.saliency_gate.proj.0.bias', 'backbone.layers.33.adapter.saliency_gate.proj.2.weight', 'backbone.layers.33.adapter.saliency_gate.proj.2.bias', 'backbone.layers.33.adapter.saliency_gate.proj.4.weight', 'backbone.layers.33.adapter.saliency_gate.proj.4.bias', 'backbone.layers.33.adapter.selective_memory.q_proj.weight', 'backbone.layers.33.adapter.selective_memory.q_proj.bias', 'backbone.layers.33.adapter.selective_memory.k_proj.weight', 'backbone.layers.33.adapter.selective_memory.k_proj.bias', 'backbone.layers.33.adapter.selective_memory.v_proj.weight', 'backbone.layers.33.adapter.selective_memory.v_proj.bias', 'backbone.layers.33.adapter.selective_memory.out_proj.weight', 'backbone.layers.33.adapter.selective_memory.out_proj.bias', 'backbone.layers.34.adapter.saliency_gate.proj.0.weight', 'backbone.layers.34.adapter.saliency_gate.proj.0.bias', 'backbone.layers.34.adapter.saliency_gate.proj.2.weight', 'backbone.layers.34.adapter.saliency_gate.proj.2.bias', 'backbone.layers.34.adapter.saliency_gate.proj.4.weight', 'backbone.layers.34.adapter.saliency_gate.proj.4.bias', 'backbone.layers.34.adapter.selective_memory.q_proj.weight', 'backbone.layers.34.adapter.selective_memory.q_proj.bias', 'backbone.layers.34.adapter.selective_memory.k_proj.weight', 'backbone.layers.34.adapter.selective_memory.k_proj.bias', 'backbone.layers.34.adapter.selective_memory.v_proj.weight', 'backbone.layers.34.adapter.selective_memory.v_proj.bias', 'backbone.layers.34.adapter.selective_memory.out_proj.weight', 'backbone.layers.34.adapter.selective_memory.out_proj.bias', 'backbone.layers.35.adapter.saliency_gate.proj.0.weight', 'backbone.layers.35.adapter.saliency_gate.proj.0.bias', 'backbone.layers.35.adapter.saliency_gate.proj.2.weight', 'backbone.layers.35.adapter.saliency_gate.proj.2.bias', 'backbone.layers.35.adapter.saliency_gate.proj.4.weight', 'backbone.layers.35.adapter.saliency_gate.proj.4.bias', 'backbone.layers.35.adapter.selective_memory.q_proj.weight', 'backbone.layers.35.adapter.selective_memory.q_proj.bias', 'backbone.layers.35.adapter.selective_memory.k_proj.weight', 'backbone.layers.35.adapter.selective_memory.k_proj.bias', 'backbone.layers.35.adapter.selective_memory.v_proj.weight', 'backbone.layers.35.adapter.selective_memory.v_proj.bias', 'backbone.layers.35.adapter.selective_memory.out_proj.weight', 'backbone.layers.35.adapter.selective_memory.out_proj.bias', 'backbone.layers.36.adapter.saliency_gate.proj.0.weight', 'backbone.layers.36.adapter.saliency_gate.proj.0.bias', 'backbone.layers.36.adapter.saliency_gate.proj.2.weight', 'backbone.layers.36.adapter.saliency_gate.proj.2.bias', 'backbone.layers.36.adapter.saliency_gate.proj.4.weight', 'backbone.layers.36.adapter.saliency_gate.proj.4.bias', 'backbone.layers.36.adapter.selective_memory.q_proj.weight', 'backbone.layers.36.adapter.selective_memory.q_proj.bias', 'backbone.layers.36.adapter.selective_memory.k_proj.weight', 'backbone.layers.36.adapter.selective_memory.k_proj.bias', 'backbone.layers.36.adapter.selective_memory.v_proj.weight', 'backbone.layers.36.adapter.selective_memory.v_proj.bias', 'backbone.layers.36.adapter.selective_memory.out_proj.weight', 'backbone.layers.36.adapter.selective_memory.out_proj.bias', 'backbone.layers.37.adapter.saliency_gate.proj.0.weight', 'backbone.layers.37.adapter.saliency_gate.proj.0.bias', 'backbone.layers.37.adapter.saliency_gate.proj.2.weight', 'backbone.layers.37.adapter.saliency_gate.proj.2.bias', 'backbone.layers.37.adapter.saliency_gate.proj.4.weight', 'backbone.layers.37.adapter.saliency_gate.proj.4.bias', 'backbone.layers.37.adapter.selective_memory.q_proj.weight', 'backbone.layers.37.adapter.selective_memory.q_proj.bias', 'backbone.layers.37.adapter.selective_memory.k_proj.weight', 'backbone.layers.37.adapter.selective_memory.k_proj.bias', 'backbone.layers.37.adapter.selective_memory.v_proj.weight', 'backbone.layers.37.adapter.selective_memory.v_proj.bias', 'backbone.layers.37.adapter.selective_memory.out_proj.weight', 'backbone.layers.37.adapter.selective_memory.out_proj.bias', 'backbone.layers.38.adapter.saliency_gate.proj.0.weight', 'backbone.layers.38.adapter.saliency_gate.proj.0.bias', 'backbone.layers.38.adapter.saliency_gate.proj.2.weight', 'backbone.layers.38.adapter.saliency_gate.proj.2.bias', 'backbone.layers.38.adapter.saliency_gate.proj.4.weight', 'backbone.layers.38.adapter.saliency_gate.proj.4.bias', 'backbone.layers.38.adapter.selective_memory.q_proj.weight', 'backbone.layers.38.adapter.selective_memory.q_proj.bias', 'backbone.layers.38.adapter.selective_memory.k_proj.weight', 'backbone.layers.38.adapter.selective_memory.k_proj.bias', 'backbone.layers.38.adapter.selective_memory.v_proj.weight', 'backbone.layers.38.adapter.selective_memory.v_proj.bias', 'backbone.layers.38.adapter.selective_memory.out_proj.weight', 'backbone.layers.38.adapter.selective_memory.out_proj.bias', 'backbone.layers.39.adapter.saliency_gate.proj.0.weight', 'backbone.layers.39.adapter.saliency_gate.proj.0.bias', 'backbone.layers.39.adapter.saliency_gate.proj.2.weight', 'backbone.layers.39.adapter.saliency_gate.proj.2.bias', 'backbone.layers.39.adapter.saliency_gate.proj.4.weight', 'backbone.layers.39.adapter.saliency_gate.proj.4.bias', 'backbone.layers.39.adapter.selective_memory.q_proj.weight', 'backbone.layers.39.adapter.selective_memory.q_proj.bias', 'backbone.layers.39.adapter.selective_memory.k_proj.weight', 'backbone.layers.39.adapter.selective_memory.k_proj.bias', 'backbone.layers.39.adapter.selective_memory.v_proj.weight', 'backbone.layers.39.adapter.selective_memory.v_proj.bias', 'backbone.layers.39.adapter.selective_memory.out_proj.weight', 'backbone.layers.39.adapter.selective_memory.out_proj.bias', 'backbone.layers.40.adapter.saliency_gate.proj.0.weight', 'backbone.layers.40.adapter.saliency_gate.proj.0.bias', 'backbone.layers.40.adapter.saliency_gate.proj.2.weight', 'backbone.layers.40.adapter.saliency_gate.proj.2.bias', 'backbone.layers.40.adapter.saliency_gate.proj.4.weight', 'backbone.layers.40.adapter.saliency_gate.proj.4.bias', 'backbone.layers.40.adapter.selective_memory.q_proj.weight', 'backbone.layers.40.adapter.selective_memory.q_proj.bias', 'backbone.layers.40.adapter.selective_memory.k_proj.weight', 'backbone.layers.40.adapter.selective_memory.k_proj.bias', 'backbone.layers.40.adapter.selective_memory.v_proj.weight', 'backbone.layers.40.adapter.selective_memory.v_proj.bias', 'backbone.layers.40.adapter.selective_memory.out_proj.weight', 'backbone.layers.40.adapter.selective_memory.out_proj.bias', 'backbone.layers.41.adapter.saliency_gate.proj.0.weight', 'backbone.layers.41.adapter.saliency_gate.proj.0.bias', 'backbone.layers.41.adapter.saliency_gate.proj.2.weight', 'backbone.layers.41.adapter.saliency_gate.proj.2.bias', 'backbone.layers.41.adapter.saliency_gate.proj.4.weight', 'backbone.layers.41.adapter.saliency_gate.proj.4.bias', 'backbone.layers.41.adapter.selective_memory.q_proj.weight', 'backbone.layers.41.adapter.selective_memory.q_proj.bias', 'backbone.layers.41.adapter.selective_memory.k_proj.weight', 'backbone.layers.41.adapter.selective_memory.k_proj.bias', 'backbone.layers.41.adapter.selective_memory.v_proj.weight', 'backbone.layers.41.adapter.selective_memory.v_proj.bias', 'backbone.layers.41.adapter.selective_memory.out_proj.weight', 'backbone.layers.41.adapter.selective_memory.out_proj.bias', 'backbone.layers.42.adapter.saliency_gate.proj.0.weight', 'backbone.layers.42.adapter.saliency_gate.proj.0.bias', 'backbone.layers.42.adapter.saliency_gate.proj.2.weight', 'backbone.layers.42.adapter.saliency_gate.proj.2.bias', 'backbone.layers.42.adapter.saliency_gate.proj.4.weight', 'backbone.layers.42.adapter.saliency_gate.proj.4.bias', 'backbone.layers.42.adapter.selective_memory.q_proj.weight', 'backbone.layers.42.adapter.selective_memory.q_proj.bias', 'backbone.layers.42.adapter.selective_memory.k_proj.weight', 'backbone.layers.42.adapter.selective_memory.k_proj.bias', 'backbone.layers.42.adapter.selective_memory.v_proj.weight', 'backbone.layers.42.adapter.selective_memory.v_proj.bias', 'backbone.layers.42.adapter.selective_memory.out_proj.weight', 'backbone.layers.42.adapter.selective_memory.out_proj.bias', 'backbone.layers.43.adapter.saliency_gate.proj.0.weight', 'backbone.layers.43.adapter.saliency_gate.proj.0.bias', 'backbone.layers.43.adapter.saliency_gate.proj.2.weight', 'backbone.layers.43.adapter.saliency_gate.proj.2.bias', 'backbone.layers.43.adapter.saliency_gate.proj.4.weight', 'backbone.layers.43.adapter.saliency_gate.proj.4.bias', 'backbone.layers.43.adapter.selective_memory.q_proj.weight', 'backbone.layers.43.adapter.selective_memory.q_proj.bias', 'backbone.layers.43.adapter.selective_memory.k_proj.weight', 'backbone.layers.43.adapter.selective_memory.k_proj.bias', 'backbone.layers.43.adapter.selective_memory.v_proj.weight', 'backbone.layers.43.adapter.selective_memory.v_proj.bias', 'backbone.layers.43.adapter.selective_memory.out_proj.weight', 'backbone.layers.43.adapter.selective_memory.out_proj.bias', 'backbone.layers.44.adapter.saliency_gate.proj.0.weight', 'backbone.layers.44.adapter.saliency_gate.proj.0.bias', 'backbone.layers.44.adapter.saliency_gate.proj.2.weight', 'backbone.layers.44.adapter.saliency_gate.proj.2.bias', 'backbone.layers.44.adapter.saliency_gate.proj.4.weight', 'backbone.layers.44.adapter.saliency_gate.proj.4.bias', 'backbone.layers.44.adapter.selective_memory.q_proj.weight', 'backbone.layers.44.adapter.selective_memory.q_proj.bias', 'backbone.layers.44.adapter.selective_memory.k_proj.weight', 'backbone.layers.44.adapter.selective_memory.k_proj.bias', 'backbone.layers.44.adapter.selective_memory.v_proj.weight', 'backbone.layers.44.adapter.selective_memory.v_proj.bias', 'backbone.layers.44.adapter.selective_memory.out_proj.weight', 'backbone.layers.44.adapter.selective_memory.out_proj.bias', 'backbone.layers.45.adapter.saliency_gate.proj.0.weight', 'backbone.layers.45.adapter.saliency_gate.proj.0.bias', 'backbone.layers.45.adapter.saliency_gate.proj.2.weight', 'backbone.layers.45.adapter.saliency_gate.proj.2.bias', 'backbone.layers.45.adapter.saliency_gate.proj.4.weight', 'backbone.layers.45.adapter.saliency_gate.proj.4.bias', 'backbone.layers.45.adapter.selective_memory.q_proj.weight', 'backbone.layers.45.adapter.selective_memory.q_proj.bias', 'backbone.layers.45.adapter.selective_memory.k_proj.weight', 'backbone.layers.45.adapter.selective_memory.k_proj.bias', 'backbone.layers.45.adapter.selective_memory.v_proj.weight', 'backbone.layers.45.adapter.selective_memory.v_proj.bias', 'backbone.layers.45.adapter.selective_memory.out_proj.weight', 'backbone.layers.45.adapter.selective_memory.out_proj.bias', 'backbone.layers.46.adapter.saliency_gate.proj.0.weight', 'backbone.layers.46.adapter.saliency_gate.proj.0.bias', 'backbone.layers.46.adapter.saliency_gate.proj.2.weight', 'backbone.layers.46.adapter.saliency_gate.proj.2.bias', 'backbone.layers.46.adapter.saliency_gate.proj.4.weight', 'backbone.layers.46.adapter.saliency_gate.proj.4.bias', 'backbone.layers.46.adapter.selective_memory.q_proj.weight', 'backbone.layers.46.adapter.selective_memory.q_proj.bias', 'backbone.layers.46.adapter.selective_memory.k_proj.weight', 'backbone.layers.46.adapter.selective_memory.k_proj.bias', 'backbone.layers.46.adapter.selective_memory.v_proj.weight', 'backbone.layers.46.adapter.selective_memory.v_proj.bias', 'backbone.layers.46.adapter.selective_memory.out_proj.weight', 'backbone.layers.46.adapter.selective_memory.out_proj.bias', 'backbone.layers.47.adapter.saliency_gate.proj.0.weight', 'backbone.layers.47.adapter.saliency_gate.proj.0.bias', 'backbone.layers.47.adapter.saliency_gate.proj.2.weight', 'backbone.layers.47.adapter.saliency_gate.proj.2.bias', 'backbone.layers.47.adapter.saliency_gate.proj.4.weight', 'backbone.layers.47.adapter.saliency_gate.proj.4.bias', 'backbone.layers.47.adapter.selective_memory.q_proj.weight', 'backbone.layers.47.adapter.selective_memory.q_proj.bias', 'backbone.layers.47.adapter.selective_memory.k_proj.weight', 'backbone.layers.47.adapter.selective_memory.k_proj.bias', 'backbone.layers.47.adapter.selective_memory.v_proj.weight', 'backbone.layers.47.adapter.selective_memory.v_proj.bias', 'backbone.layers.47.adapter.selective_memory.out_proj.weight', 'backbone.layers.47.adapter.selective_memory.out_proj.bias', 'backbone.layers.48.adapter.saliency_gate.proj.0.weight', 'backbone.layers.48.adapter.saliency_gate.proj.0.bias', 'backbone.layers.48.adapter.saliency_gate.proj.2.weight', 'backbone.layers.48.adapter.saliency_gate.proj.2.bias', 'backbone.layers.48.adapter.saliency_gate.proj.4.weight', 'backbone.layers.48.adapter.saliency_gate.proj.4.bias', 'backbone.layers.48.adapter.selective_memory.q_proj.weight', 'backbone.layers.48.adapter.selective_memory.q_proj.bias', 'backbone.layers.48.adapter.selective_memory.k_proj.weight', 'backbone.layers.48.adapter.selective_memory.k_proj.bias', 'backbone.layers.48.adapter.selective_memory.v_proj.weight', 'backbone.layers.48.adapter.selective_memory.v_proj.bias', 'backbone.layers.48.adapter.selective_memory.out_proj.weight', 'backbone.layers.48.adapter.selective_memory.out_proj.bias', 'backbone.layers.49.adapter.saliency_gate.proj.0.weight', 'backbone.layers.49.adapter.saliency_gate.proj.0.bias', 'backbone.layers.49.adapter.saliency_gate.proj.2.weight', 'backbone.layers.49.adapter.saliency_gate.proj.2.bias', 'backbone.layers.49.adapter.saliency_gate.proj.4.weight', 'backbone.layers.49.adapter.saliency_gate.proj.4.bias', 'backbone.layers.49.adapter.selective_memory.q_proj.weight', 'backbone.layers.49.adapter.selective_memory.q_proj.bias', 'backbone.layers.49.adapter.selective_memory.k_proj.weight', 'backbone.layers.49.adapter.selective_memory.k_proj.bias', 'backbone.layers.49.adapter.selective_memory.v_proj.weight', 'backbone.layers.49.adapter.selective_memory.v_proj.bias', 'backbone.layers.49.adapter.selective_memory.out_proj.weight', 'backbone.layers.49.adapter.selective_memory.out_proj.bias', 'backbone.layers.50.adapter.saliency_gate.proj.0.weight', 'backbone.layers.50.adapter.saliency_gate.proj.0.bias', 'backbone.layers.50.adapter.saliency_gate.proj.2.weight', 'backbone.layers.50.adapter.saliency_gate.proj.2.bias', 'backbone.layers.50.adapter.saliency_gate.proj.4.weight', 'backbone.layers.50.adapter.saliency_gate.proj.4.bias', 'backbone.layers.50.adapter.selective_memory.q_proj.weight', 'backbone.layers.50.adapter.selective_memory.q_proj.bias', 'backbone.layers.50.adapter.selective_memory.k_proj.weight', 'backbone.layers.50.adapter.selective_memory.k_proj.bias', 'backbone.layers.50.adapter.selective_memory.v_proj.weight', 'backbone.layers.50.adapter.selective_memory.v_proj.bias', 'backbone.layers.50.adapter.selective_memory.out_proj.weight', 'backbone.layers.50.adapter.selective_memory.out_proj.bias', 'backbone.layers.51.adapter.saliency_gate.proj.0.weight', 'backbone.layers.51.adapter.saliency_gate.proj.0.bias', 'backbone.layers.51.adapter.saliency_gate.proj.2.weight', 'backbone.layers.51.adapter.saliency_gate.proj.2.bias', 'backbone.layers.51.adapter.saliency_gate.proj.4.weight', 'backbone.layers.51.adapter.saliency_gate.proj.4.bias', 'backbone.layers.51.adapter.selective_memory.q_proj.weight', 'backbone.layers.51.adapter.selective_memory.q_proj.bias', 'backbone.layers.51.adapter.selective_memory.k_proj.weight', 'backbone.layers.51.adapter.selective_memory.k_proj.bias', 'backbone.layers.51.adapter.selective_memory.v_proj.weight', 'backbone.layers.51.adapter.selective_memory.v_proj.bias', 'backbone.layers.51.adapter.selective_memory.out_proj.weight', 'backbone.layers.51.adapter.selective_memory.out_proj.bias', 'backbone.layers.52.adapter.saliency_gate.proj.0.weight', 'backbone.layers.52.adapter.saliency_gate.proj.0.bias', 'backbone.layers.52.adapter.saliency_gate.proj.2.weight', 'backbone.layers.52.adapter.saliency_gate.proj.2.bias', 'backbone.layers.52.adapter.saliency_gate.proj.4.weight', 'backbone.layers.52.adapter.saliency_gate.proj.4.bias', 'backbone.layers.52.adapter.selective_memory.q_proj.weight', 'backbone.layers.52.adapter.selective_memory.q_proj.bias', 'backbone.layers.52.adapter.selective_memory.k_proj.weight', 'backbone.layers.52.adapter.selective_memory.k_proj.bias', 'backbone.layers.52.adapter.selective_memory.v_proj.weight', 'backbone.layers.52.adapter.selective_memory.v_proj.bias', 'backbone.layers.52.adapter.selective_memory.out_proj.weight', 'backbone.layers.52.adapter.selective_memory.out_proj.bias', 'backbone.layers.53.adapter.saliency_gate.proj.0.weight', 'backbone.layers.53.adapter.saliency_gate.proj.0.bias', 'backbone.layers.53.adapter.saliency_gate.proj.2.weight', 'backbone.layers.53.adapter.saliency_gate.proj.2.bias', 'backbone.layers.53.adapter.saliency_gate.proj.4.weight', 'backbone.layers.53.adapter.saliency_gate.proj.4.bias', 'backbone.layers.53.adapter.selective_memory.q_proj.weight', 'backbone.layers.53.adapter.selective_memory.q_proj.bias', 'backbone.layers.53.adapter.selective_memory.k_proj.weight', 'backbone.layers.53.adapter.selective_memory.k_proj.bias', 'backbone.layers.53.adapter.selective_memory.v_proj.weight', 'backbone.layers.53.adapter.selective_memory.v_proj.bias', 'backbone.layers.53.adapter.selective_memory.out_proj.weight', 'backbone.layers.53.adapter.selective_memory.out_proj.bias', 'backbone.layers.54.adapter.saliency_gate.proj.0.weight', 'backbone.layers.54.adapter.saliency_gate.proj.0.bias', 'backbone.layers.54.adapter.saliency_gate.proj.2.weight', 'backbone.layers.54.adapter.saliency_gate.proj.2.bias', 'backbone.layers.54.adapter.saliency_gate.proj.4.weight', 'backbone.layers.54.adapter.saliency_gate.proj.4.bias', 'backbone.layers.54.adapter.selective_memory.q_proj.weight', 'backbone.layers.54.adapter.selective_memory.q_proj.bias', 'backbone.layers.54.adapter.selective_memory.k_proj.weight', 'backbone.layers.54.adapter.selective_memory.k_proj.bias', 'backbone.layers.54.adapter.selective_memory.v_proj.weight', 'backbone.layers.54.adapter.selective_memory.v_proj.bias', 'backbone.layers.54.adapter.selective_memory.out_proj.weight', 'backbone.layers.54.adapter.selective_memory.out_proj.bias', 'backbone.layers.55.adapter.saliency_gate.proj.0.weight', 'backbone.layers.55.adapter.saliency_gate.proj.0.bias', 'backbone.layers.55.adapter.saliency_gate.proj.2.weight', 'backbone.layers.55.adapter.saliency_gate.proj.2.bias', 'backbone.layers.55.adapter.saliency_gate.proj.4.weight', 'backbone.layers.55.adapter.saliency_gate.proj.4.bias', 'backbone.layers.55.adapter.selective_memory.q_proj.weight', 'backbone.layers.55.adapter.selective_memory.q_proj.bias', 'backbone.layers.55.adapter.selective_memory.k_proj.weight', 'backbone.layers.55.adapter.selective_memory.k_proj.bias', 'backbone.layers.55.adapter.selective_memory.v_proj.weight', 'backbone.layers.55.adapter.selective_memory.v_proj.bias', 'backbone.layers.55.adapter.selective_memory.out_proj.weight', 'backbone.layers.55.adapter.selective_memory.out_proj.bias', 'backbone.layers.56.adapter.saliency_gate.proj.0.weight', 'backbone.layers.56.adapter.saliency_gate.proj.0.bias', 'backbone.layers.56.adapter.saliency_gate.proj.2.weight', 'backbone.layers.56.adapter.saliency_gate.proj.2.bias', 'backbone.layers.56.adapter.saliency_gate.proj.4.weight', 'backbone.layers.56.adapter.saliency_gate.proj.4.bias', 'backbone.layers.56.adapter.selective_memory.q_proj.weight', 'backbone.layers.56.adapter.selective_memory.q_proj.bias', 'backbone.layers.56.adapter.selective_memory.k_proj.weight', 'backbone.layers.56.adapter.selective_memory.k_proj.bias', 'backbone.layers.56.adapter.selective_memory.v_proj.weight', 'backbone.layers.56.adapter.selective_memory.v_proj.bias', 'backbone.layers.56.adapter.selective_memory.out_proj.weight', 'backbone.layers.56.adapter.selective_memory.out_proj.bias', 'backbone.layers.57.adapter.saliency_gate.proj.0.weight', 'backbone.layers.57.adapter.saliency_gate.proj.0.bias', 'backbone.layers.57.adapter.saliency_gate.proj.2.weight', 'backbone.layers.57.adapter.saliency_gate.proj.2.bias', 'backbone.layers.57.adapter.saliency_gate.proj.4.weight', 'backbone.layers.57.adapter.saliency_gate.proj.4.bias', 'backbone.layers.57.adapter.selective_memory.q_proj.weight', 'backbone.layers.57.adapter.selective_memory.q_proj.bias', 'backbone.layers.57.adapter.selective_memory.k_proj.weight', 'backbone.layers.57.adapter.selective_memory.k_proj.bias', 'backbone.layers.57.adapter.selective_memory.v_proj.weight', 'backbone.layers.57.adapter.selective_memory.v_proj.bias', 'backbone.layers.57.adapter.selective_memory.out_proj.weight', 'backbone.layers.57.adapter.selective_memory.out_proj.bias', 'backbone.layers.58.adapter.saliency_gate.proj.0.weight', 'backbone.layers.58.adapter.saliency_gate.proj.0.bias', 'backbone.layers.58.adapter.saliency_gate.proj.2.weight', 'backbone.layers.58.adapter.saliency_gate.proj.2.bias', 'backbone.layers.58.adapter.saliency_gate.proj.4.weight', 'backbone.layers.58.adapter.saliency_gate.proj.4.bias', 'backbone.layers.58.adapter.selective_memory.q_proj.weight', 'backbone.layers.58.adapter.selective_memory.q_proj.bias', 'backbone.layers.58.adapter.selective_memory.k_proj.weight', 'backbone.layers.58.adapter.selective_memory.k_proj.bias', 'backbone.layers.58.adapter.selective_memory.v_proj.weight', 'backbone.layers.58.adapter.selective_memory.v_proj.bias', 'backbone.layers.58.adapter.selective_memory.out_proj.weight', 'backbone.layers.58.adapter.selective_memory.out_proj.bias', 'backbone.layers.59.adapter.saliency_gate.proj.0.weight', 'backbone.layers.59.adapter.saliency_gate.proj.0.bias', 'backbone.layers.59.adapter.saliency_gate.proj.2.weight', 'backbone.layers.59.adapter.saliency_gate.proj.2.bias', 'backbone.layers.59.adapter.saliency_gate.proj.4.weight', 'backbone.layers.59.adapter.saliency_gate.proj.4.bias', 'backbone.layers.59.adapter.selective_memory.q_proj.weight', 'backbone.layers.59.adapter.selective_memory.q_proj.bias', 'backbone.layers.59.adapter.selective_memory.k_proj.weight', 'backbone.layers.59.adapter.selective_memory.k_proj.bias', 'backbone.layers.59.adapter.selective_memory.v_proj.weight', 'backbone.layers.59.adapter.selective_memory.v_proj.bias', 'backbone.layers.59.adapter.selective_memory.out_proj.weight', 'backbone.layers.59.adapter.selective_memory.out_proj.bias', 'backbone.layers.60.adapter.saliency_gate.proj.0.weight', 'backbone.layers.60.adapter.saliency_gate.proj.0.bias', 'backbone.layers.60.adapter.saliency_gate.proj.2.weight', 'backbone.layers.60.adapter.saliency_gate.proj.2.bias', 'backbone.layers.60.adapter.saliency_gate.proj.4.weight', 'backbone.layers.60.adapter.saliency_gate.proj.4.bias', 'backbone.layers.60.adapter.selective_memory.q_proj.weight', 'backbone.layers.60.adapter.selective_memory.q_proj.bias', 'backbone.layers.60.adapter.selective_memory.k_proj.weight', 'backbone.layers.60.adapter.selective_memory.k_proj.bias', 'backbone.layers.60.adapter.selective_memory.v_proj.weight', 'backbone.layers.60.adapter.selective_memory.v_proj.bias', 'backbone.layers.60.adapter.selective_memory.out_proj.weight', 'backbone.layers.60.adapter.selective_memory.out_proj.bias', 'backbone.layers.61.adapter.saliency_gate.proj.0.weight', 'backbone.layers.61.adapter.saliency_gate.proj.0.bias', 'backbone.layers.61.adapter.saliency_gate.proj.2.weight', 'backbone.layers.61.adapter.saliency_gate.proj.2.bias', 'backbone.layers.61.adapter.saliency_gate.proj.4.weight', 'backbone.layers.61.adapter.saliency_gate.proj.4.bias', 'backbone.layers.61.adapter.selective_memory.q_proj.weight', 'backbone.layers.61.adapter.selective_memory.q_proj.bias', 'backbone.layers.61.adapter.selective_memory.k_proj.weight', 'backbone.layers.61.adapter.selective_memory.k_proj.bias', 'backbone.layers.61.adapter.selective_memory.v_proj.weight', 'backbone.layers.61.adapter.selective_memory.v_proj.bias', 'backbone.layers.61.adapter.selective_memory.out_proj.weight', 'backbone.layers.61.adapter.selective_memory.out_proj.bias', 'backbone.layers.62.adapter.saliency_gate.proj.0.weight', 'backbone.layers.62.adapter.saliency_gate.proj.0.bias', 'backbone.layers.62.adapter.saliency_gate.proj.2.weight', 'backbone.layers.62.adapter.saliency_gate.proj.2.bias', 'backbone.layers.62.adapter.saliency_gate.proj.4.weight', 'backbone.layers.62.adapter.saliency_gate.proj.4.bias', 'backbone.layers.62.adapter.selective_memory.q_proj.weight', 'backbone.layers.62.adapter.selective_memory.q_proj.bias', 'backbone.layers.62.adapter.selective_memory.k_proj.weight', 'backbone.layers.62.adapter.selective_memory.k_proj.bias', 'backbone.layers.62.adapter.selective_memory.v_proj.weight', 'backbone.layers.62.adapter.selective_memory.v_proj.bias', 'backbone.layers.62.adapter.selective_memory.out_proj.weight', 'backbone.layers.62.adapter.selective_memory.out_proj.bias', 'backbone.layers.63.adapter.saliency_gate.proj.0.weight', 'backbone.layers.63.adapter.saliency_gate.proj.0.bias', 'backbone.layers.63.adapter.saliency_gate.proj.2.weight', 'backbone.layers.63.adapter.saliency_gate.proj.2.bias', 'backbone.layers.63.adapter.saliency_gate.proj.4.weight', 'backbone.layers.63.adapter.saliency_gate.proj.4.bias', 'backbone.layers.63.adapter.selective_memory.q_proj.weight', 'backbone.layers.63.adapter.selective_memory.q_proj.bias', 'backbone.layers.63.adapter.selective_memory.k_proj.weight', 'backbone.layers.63.adapter.selective_memory.k_proj.bias', 'backbone.layers.63.adapter.selective_memory.v_proj.weight', 'backbone.layers.63.adapter.selective_memory.v_proj.bias', 'backbone.layers.63.adapter.selective_memory.out_proj.weight', 'backbone.layers.63.adapter.selective_memory.out_proj.bias', 'lm_head.weight']
2025-11-18 01:18:57 | WARNING | __main__ | Unexpected keys when loading weights: ['backbone.embeddings.weight']
Traceback (most recent call last):
  File "/storage/ice1/6/8/htang318/mamba/train_reflong.py", line 445, in <module>
    main()
    ~~~~^^
  File "/storage/ice1/6/8/htang318/mamba/train_reflong.py", line 411, in main
    outputs = model(input_ids=input_ids, saliency_scores=saliency_scores)
  File "/home/hice1/htang318/miniconda3/envs/mamba/lib/python3.14/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/hice1/htang318/miniconda3/envs/mamba/lib/python3.14/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/hice1/htang318/miniconda3/envs/mamba/lib/python3.14/site-packages/accelerate/utils/operations.py", line 819, in forward
    return model_forward(*args, **kwargs)
  File "/home/hice1/htang318/miniconda3/envs/mamba/lib/python3.14/site-packages/accelerate/utils/operations.py", line 807, in __call__
    return convert_to_fp32(self.model_forward(*args, **kwargs))
                           ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/hice1/htang318/miniconda3/envs/mamba/lib/python3.14/site-packages/torch/amp/autocast_mode.py", line 44, in decorate_autocast
    return func(*args, **kwargs)
  File "/storage/ice1/6/8/htang318/mamba/mamba_ssm/models/mixer_seq_simple.py", line 320, in forward
    hidden_states = self.backbone(input_ids, inference_params=inference_params, **mixer_kwargs)
  File "/home/hice1/htang318/miniconda3/envs/mamba/lib/python3.14/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/hice1/htang318/miniconda3/envs/mamba/lib/python3.14/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
  File "/storage/ice1/6/8/htang318/mamba/mamba_ssm/models/mixer_seq_simple.py", line 229, in forward
    hidden_states, residual = layer(
                              ~~~~~^
        hidden_states,
        ^^^^^^^^^^^^^^
    ...<3 lines>...
        **mixer_kwargs,
        ^^^^^^^^^^^^^^^
    )
    ^
  File "/home/hice1/htang318/miniconda3/envs/mamba/lib/python3.14/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/hice1/htang318/miniconda3/envs/mamba/lib/python3.14/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
  File "/storage/ice1/6/8/htang318/mamba/mamba_ssm/modules/block.py", line 103, in forward
    hidden_states = self.adapter(hidden_states, **adapter_kwargs)
  File "/home/hice1/htang318/miniconda3/envs/mamba/lib/python3.14/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/hice1/htang318/miniconda3/envs/mamba/lib/python3.14/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
  File "/storage/ice1/6/8/htang318/mamba/mamba_ssm/modules/smh_adapter.py", line 148, in forward
    hidden_states = self.selective_memory(hidden_states)
  File "/home/hice1/htang318/miniconda3/envs/mamba/lib/python3.14/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/hice1/htang318/miniconda3/envs/mamba/lib/python3.14/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
  File "/storage/ice1/6/8/htang318/mamba/mamba_ssm/modules/smh_adapter.py", line 93, in forward
    patches = self._gather_patches(hidden_states, window)  # (B, L, W, D)
  File "/storage/ice1/6/8/htang318/mamba/mamba_ssm/modules/smh_adapter.py", line 119, in _gather_patches
    return patches.contiguous()
           ~~~~~~~~~~~~~~~~~~^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.54 GiB. GPU 0 has a total capacity of 79.25 GiB of which 453.88 MiB is free. Including non-PyTorch memory, this process has 78.80 GiB memory in use. Of the allocated memory 77.89 GiB is allocated by PyTorch, and 418.61 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/home/hice1/htang318/miniconda3/envs/mamba/lib/python3.14/site-packages/accelerate/commands/launch.py", line 1245, in <module>
    main()
    ~~~~^^
  File "/home/hice1/htang318/miniconda3/envs/mamba/lib/python3.14/site-packages/accelerate/commands/launch.py", line 1241, in main
    launch_command(args)
    ~~~~~~~~~~~~~~^^^^^^
  File "/home/hice1/htang318/miniconda3/envs/mamba/lib/python3.14/site-packages/accelerate/commands/launch.py", line 1235, in launch_command
    simple_launcher(args)
    ~~~~~~~~~~~~~~~^^^^^^
  File "/home/hice1/htang318/miniconda3/envs/mamba/lib/python3.14/site-packages/accelerate/commands/launch.py", line 823, in simple_launcher
    raise subprocess.CalledProcessError(returncode=process.returncode, cmd=cmd)
subprocess.CalledProcessError: Command '['/home/hice1/htang318/miniconda3/envs/mamba/bin/python', 'train_reflong.py', '--model_name_or_path', '/storage/ice1/6/8/htang318/mamba-2.8b-hf', '--adapter_config', 'mamba_ssm/smh_ref_long.json', '--dataset_path', '/home/hice1/htang318/scratch/Ref-Long-full/data/Ref-Long-A/before/multi_stars_hard_24K.json', '--answers_path', '/home/hice1/htang318/scratch/Ref-Long-full/data/Ref-Long-A/answers/multi_stars_hard_24K_answers.json', '--output_dir', 'outputs/reflong_mamba_adapter', '--logging_dir', 'logs/reflong_mamba_adapter', '--per_device_train_batch_size', '1', '--per_device_eval_batch_size', '1', '--gradient_accumulation_steps', '16', '--num_train_epochs', '3', '--learning_rate', '2e-5', '--warmup_ratio', '0.03', '--lr_scheduler_type', 'cosine', '--weight_decay', '0.1', '--max_seq_length', '32768', '--save_steps', '500', '--eval_steps', '500', '--save_total_limit', '3', '--load_best_model_at_end', '--metric_for_best_model', 'eval_accuracy', '--greater_is_better', '--bf16', '--logging_steps', '25']' returned non-zero exit status 1.
